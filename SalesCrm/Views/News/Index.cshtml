@using SalesCrm.Views.Components.Pagination
@using Microsoft.AspNetCore.Mvc.TagHelpers
@model SalesCrm.Views.Components.Pagination.PaginationList<SalesCrm.Controllers.ViewModels.NewsViewModel>

@{
    ViewData["Title"] = "News Page";
}

<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-body">
                
                <!-- Card breadcrumb -->
                @await Html.PartialAsync("_BreadcrumbPartial", new[] {@ViewData["Title"]!.ToString(), ""})
                <!-- Card breadcrumb  -->
                <br/>

                <!-- Card title -->
                <div class="row">
                    <div class="col-md-12">
                        <h2 class="page-title">@ViewData["Title"]</h2>
                    </div>
                </div>
                <br/>
                @* <hr style="opacity:0.5!important"/> *@
                <!-- Card title -->

                <div class="row">
                    <div class="col-md-4">
                        @using (Html.BeginForm("Index", "News", FormMethod.Get))
                        {
                            @await Html.PartialAsync("_SearcherPartial")
                        }
                    </div>

                    <div class="col-md-6" style="padding-top:30px">
                        <div class="text-md-end">
                            <a asp-action="Create" class="btn btn-primary">
                                Create news
                            </a>
                        </div>
                    </div>
                </div>
            </div> <br/>

            <table class="table">
                <tr>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Author</th>
                    <th>Create date</th>
                    <th>Publishe date</th>
                    <th>Update date</th>
                    <th>Activity</th>
                    <th style="text-align:center">Actions</th>
                </tr>

                @foreach (var item in Model)
                {
                    <tr>
                        <td>@item.Title</td>
                        <td>@item.Description</td>
                        <td>@item.Author!.UserName</td>
                        <td>@item.CreatedAt.ToString("dd.MM.yyyy")</td>
                        <td>@item.PublishedAt.ToString("dd.MM.yyyy")</td>
                        <td>@item.UpdatedAt.ToString("dd.MM.yyyy")</td>
                        <td>@item.IsActive.ToString().ToLower()</td>
                        <td style="text-align:center">
                            <button class="btn btn-outline-primary button"
                                    onclick="location.href='@Url.Action("EditNews", new {id = item.Id})'">
                                edit
                            </button>

                            <button class="btn btn-outline-danger button"
                                    onclick="showConfirmationDialog(event, 'Are you sure you want to delete this news?',
                                        '@Url.Action("DeleteNews", new {id = item.Id})')">
                                delete
                            </button>
                        </td>
                    </tr>
                }
            </table>
        </div>
    </div>

</div>

@Html.Partial("../Components/Pagination/_Pagination", new PaginationViewModel
{
    ActionName = "Index",
    PageNumber = Model.PageNumber,
    PageSize = Model.PageSize,
    IsPreviousPageAvailable = Model.IsPreviousPageAvailable,
    IsNextPageAvailable = Model.IsNextPageAvailable,
    TotalPages = Model.TotalPages
})

@section Scripts
{
    @{
        @Html.Partial("../Components/DeleteModal/_DeleteConfirmationModal")
    }
}

<style>
    table {
      padding: 10px;
    }
    
    td, th {
      padding: 10px;
    }
    
    .button {
      padding:0rem 0.9rem
    }
</style>